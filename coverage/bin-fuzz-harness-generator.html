<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.51
Devel::Cover is copyright 2001-2025, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
https://pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: bin/fuzz-harness-generator</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">bin/fuzz-harness-generator</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">35.7%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s">#!/usr/bin/env perl</td></tr>
<tr><td class="h">2</td><td colspan="6"></td></tr><tr><td class="h">3</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L3">6</a></div></td><td><div>11399</div><div>7</div><div>122</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">4</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L4">6</a></div></td><td><div>12</div><div>3</div><div>117</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">5</td><td colspan="6"></td></tr><tr><td class="h">6</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L6">6</a></div></td><td><div>1740</div><div>8</div><div>132</div></td><td class="s">use App::Test::Generator;</td></tr>
<tr><td class="h">7</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L7">6</a></div></td><td><div>13</div><div>5</div><div>17</div></td><td class="s">use autodie qw(:all);</td></tr>
<tr><td class="h">8</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L8">6</a></div></td><td><div>12609</div><div>6</div><div>198</div></td><td class="s">use File::Temp;</td></tr>
<tr><td class="h">9</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L9">6</a></div></td><td><div>2006</div><div>27268</div><div>12</div></td><td class="s">use Getopt::Long qw(GetOptions);</td></tr>
<tr><td class="h">10</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L10">6</a></div></td><td><div>1703</div><div>114709</div><div>240436</div></td><td class="s">use Pod::Usage;</td></tr>
<tr><td class="h">11</td><td colspan="6"></td></tr><tr><td class="h">12 - 90</td><td colspan="5"></td><td class="s"><pre>=head1 NAME

fuzz-harness-generator - Generate fuzzing + corpus-based test harnesses from test schemas

=head1 SYNOPSIS

&nbsp;&nbsp;fuzz-harness-generator [-r] [-o output_file] input.yaml
&nbsp;&nbsp;fuzz-harness-generator --dry-run input.yaml
&nbsp;&nbsp;fuzz-harness-generator --replay-corpus schemas/corpus/ -o t/fuzz_replay.t
&nbsp;&nbsp;fuzz-harness-generator --replay-corpus schemas/corpus/translate.json -o t/fuzz_replay.t

=head1 DESCRIPTION

This tool generates a test file that fuzzes and validates a target module&#39;s function or method,
using both randomized fuzz cases and a static corpus cases (Perl or YAML).

It can also generate regression test files from corpus JSON files previously
written by C&lt;extract-schemas --fuzz&gt;, using C&lt;--replay-corpus&gt;.

A starter C&lt;input.yaml&gt; can be created using C&lt;extract-schemas&gt; which is also in this package.

=head1 OPTIONS

=over 4

=item B&lt;--help&gt;

Show this help.

=item B&lt;--input&gt;

The input configuration file

=item B&lt;--output&gt;

The (optional) output file.

=item B&lt;--dry-run&gt;

Validate the input configuration and schema extraction without writing any output files or running tests.

=item B&lt;--run&gt;

Call C&lt;prove&gt; on the output file.

C&lt;fuzz-harness-generator -r t/conf/data_text_append.conf&gt; will, therefore, dynamically create and run tests on the C&lt;append&gt; method of L&lt;Data::Text&gt;

=item B&lt;--replay-corpus&gt; PATH

Instead of generating a fuzz harness, generate a regression test file from
one or more corpus JSON files previously written by C&lt;extract-schemas --fuzz&gt;.

PATH may be either:

=over 4

=item * A single corpus file, e.g. C&lt;schemas/corpus/translate.json&gt;

=item * A directory, e.g. C&lt;schemas/corpus/&gt; &acirc;&#128;&#148; all C&lt;*.json&gt; files in that
directory will be included

=back

The generated test file contains one failing test per bug recorded in the
corpus. Each test calls the target method with the exact input that previously
caused a crash and expects it B&lt;not&gt; to die. Tests will be red until the
underlying bug is fixed, at which point they go green and stay green &acirc;&#128;&#148;
acting as permanent regression tests.

Only corpus entries with recorded bugs are included. Clean corpus entries
(inputs that did not cause a bug) are ignored.

=item B&lt;--version&gt;

Prints the version of L&lt;App::Test::Generator&gt;

=back

=cut</pre></td></tr>
<tr><td class="h">91</td><td colspan="6"></td></tr><tr><td class="h">92</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>200490</div></td><td class="s">my $infile;</td></tr>
<tr><td class="h">93</td><td></td><td></td><td></td><td></td><td></td><td class="s">my $outfile;</td></tr>
<tr><td class="h">94</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $help;</td></tr>
<tr><td class="h">95</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $run;</td></tr>
<tr><td class="h">96</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $verbose;</td></tr>
<tr><td class="h">97</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $version;</td></tr>
<tr><td class="h">98</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $dry_run;</td></tr>
<tr><td class="h">99</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $replay_corpus;</td></tr>
<tr><td class="h">100</td><td colspan="6"></td></tr><tr><td class="h">101</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">Getopt::Long::Configure(&#39;bundling&#39;);</td></tr>
<tr><td class="h">102</td><td colspan="6"></td></tr><tr><td class="h">103</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L103">50</a></div></td><td></td><td></td><td><div>133</div></td><td class="s">GetOptions(</td></tr>
<tr><td class="h">104</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;help|h&#39; =&gt; \$help,</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;input|i=s&#39; =&gt; \$infile,</td></tr>
<tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;dry-run|n&#39; =&gt; \$dry_run,</td></tr>
<tr><td class="h">107</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;output|o=s&#39; =&gt; \$outfile,</td></tr>
<tr><td class="h">108</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;run|r&#39; =&gt; \$run,</td></tr>
<tr><td class="h">109</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;verbose|v&#39; =&gt; \$verbose,</td></tr>
<tr><td class="h">110</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;version|V&#39; =&gt; \$version,</td></tr>
<tr><td class="h">111</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;replay-corpus|R=s&#39; =&gt; \$replay_corpus,</td></tr>
<tr><td class="h">112</td><td></td><td></td><td></td><td></td><td></td><td class="s">) or pod2usage(2);</td></tr>
<tr><td class="h">113</td><td colspan="6"></td></tr><tr><td class="h">114</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L114">100</a></div></td><td></td><td></td><td><div>3106</div></td><td class="s">pod2usage(-exitval =&gt; 0, -verbose =&gt; 1) if($help);</td></tr>
<tr><td class="h">115</td><td colspan="6"></td></tr><tr><td class="h">116</td><td><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L116">100</a></div></td><td></td><td></td><td><div>11</div></td><td class="s">if($version) {</td></tr>
<tr><td class="h">117</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print $App::Test::Generator::VERSION, &quot;\n&quot;;</td></tr>
<tr><td class="h">118</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 0;</td></tr>
<tr><td class="h">119</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">120</td><td colspan="6"></td></tr><tr><td class="h">121</td><td></td><td></td><td></td><td></td><td></td><td class="s"># ---------------------------------------------------------------------------</td></tr>
<tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td class="s"># --replay-corpus mode: generate a regression .t from corpus bug entries</td></tr>
<tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td class="s"># ---------------------------------------------------------------------------</td></tr>
<tr><td class="h">124</td><td colspan="6"></td></tr><tr><td class="h">125</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L125">50</a></div></td><td></td><td></td><td><div>27</div></td><td class="s">if ($replay_corpus) {</td></tr>
<tr><td class="h">126</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L126">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pod2usage(&#39;--replay-corpus cannot be combined with --dry-run&#39;) if $dry_run;</td></tr>
<tr><td class="h">127</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L127">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pod2usage(&#39;--replay-corpus cannot be combined with --input&#39;) if $infile;</td></tr>
<tr><td class="h">128</td><td colspan="6"></td></tr><tr><td class="h">129</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @corpus_files = _collect_corpus_files($replay_corpus);</td></tr>
<tr><td class="h">130</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L130">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;No corpus JSON files found at: $replay_corpus&quot; unless @corpus_files;</td></tr>
<tr><td class="h">131</td><td colspan="6"></td></tr><tr><td class="h">132</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tap = _generate_replay_tap(@corpus_files);</td></tr>
<tr><td class="h">133</td><td colspan="6"></td></tr><tr><td class="h">134</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L134">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($outfile) {</td></tr>
<tr><td class="h">135</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L135">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open my $fh, &#39;&gt;&#39;, $outfile or die &quot;Cannot write to $outfile: $!&quot;;</td></tr>
<tr><td class="h">136</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print $fh $tap;</td></tr>
<tr><td class="h">137</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">138</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod 0755, $outfile;</td></tr>
<tr><td class="h">139</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;Replay test written to: $outfile\n&quot;;</td></tr>
<tr><td class="h">140</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L140">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($run) {</td></tr>
<tr><td class="h">141</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit system(&#39;prove&#39;, &#39;-l&#39;, $outfile) &gt;&gt; 8;</td></tr>
<tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">143</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">144</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print $tap;</td></tr>
<tr><td class="h">145</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">146</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 0;</td></tr>
<tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">148</td><td colspan="6"></td></tr><tr><td class="h">149</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L149">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L149">33</a></div></td><td></td><td><div>23</div></td><td class="s">if($infile &amp;&amp; @ARGV) {</td></tr>
<tr><td class="h">150</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pod2usage(&#39;Specify input file either as argument or via --input, not both&#39;);</td></tr>
<tr><td class="h">151</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">152</td><td colspan="6"></td></tr><tr><td class="h">153</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L153">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L153">33</a></div></td><td></td><td><div>9</div></td><td class="s">$infile ||= shift @ARGV or pod2usage(&#39;No config file given&#39;);</td></tr>
<tr><td class="h">154</td><td colspan="6"></td></tr><tr><td class="h">155</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L155">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L155">67</a></div></td><td></td><td><div>19</div></td><td class="s">if($dry_run &amp;&amp; $run) {</td></tr>
<tr><td class="h">156</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pod2usage(&#39;--dry-run cannot be used with --run&#39;);</td></tr>
<tr><td class="h">157</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">158</td><td colspan="6"></td></tr><tr><td class="h">159</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L159">100</a></div></td><td><div class="c3"><a href="bin-fuzz-harness-generator--condition.html#L159">100</a></div></td><td></td><td><div>9</div></td><td class="s">if ($dry_run &amp;&amp; $outfile) {</td></tr>
<tr><td class="h">160</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn &#39;--dry-run specified; --output will be ignored&#39;;</td></tr>
<tr><td class="h">161</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">162</td><td colspan="6"></td></tr><tr><td class="h">163</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L163">50</a></div></td><td></td><td></td><td><div>216</div></td><td class="s">if($verbose) {</td></tr>
<tr><td class="h">164</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ENV{&#39;TEST_VERBOSE&#39;} = 1;</td></tr>
<tr><td class="h">165</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">166</td><td colspan="6"></td></tr><tr><td class="h">167</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L167">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L167">33</a></div></td><td></td><td><div>7</div></td><td class="s">if($run &amp;&amp; !$outfile) {</td></tr>
<tr><td class="h">168</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $fh;</td></tr>
<tr><td class="h">169</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($fh, $outfile) = File::Temp::tempfile();</td></tr>
<tr><td class="h">170</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">171</td><td colspan="6"></td></tr><tr><td class="h">172</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;App::Test::Generator::generate($infile, $outfile);</td></tr>
<tr><td class="h">173</td><td colspan="6"></td></tr><tr><td class="h">174</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit system(&#39;prove&#39;, &#39;-l&#39;, $outfile) &gt;&gt; 8;</td></tr>
<tr><td class="h">175</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">176</td><td colspan="6"></td></tr><tr><td class="h">177</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L177">100</a></div><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L177">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L177">25</a></div></td><td></td><td><div>13</div></td><td class="s">if ($dry_run) {</td></tr>
<tr><td class="h">178</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($fh, $tmp) = File::Temp::tempfile();</td></tr>
<tr><td class="h">179</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>894</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">180</td><td colspan="6"></td></tr><tr><td class="h">181</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval {</td></tr>
<tr><td class="h">182</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;App::Test::Generator::generate($infile, $tmp);</td></tr>
<tr><td class="h">183</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1;</td></tr>
<tr><td class="h">184</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L184">100</a></div></td><td></td><td></td><td><div>1319</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} or do {</td></tr>
<tr><td class="h">185</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>348</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Dry-run failed for $infile: $@&quot;;</td></tr>
<tr><td class="h">186</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">187</td><td colspan="6"></td></tr><tr><td class="h">188</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink $tmp;</td></tr>
<tr><td class="h">189</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>2124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;Dry-run OK: $infile parsed and validated successfully\n&quot;;</td></tr>
<tr><td class="h">190</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 0;</td></tr>
<tr><td class="h">191</td><td></td><td></td><td></td><td></td><td></td><td class="s">} elsif($outfile &amp;&amp; -e $outfile &amp;&amp; !$run) {</td></tr>
<tr><td class="h">192</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn &quot;Overwriting existing file: $outfile&quot;;</td></tr>
<tr><td class="h">193</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">194</td><td colspan="6"></td></tr><tr><td class="h">195</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">App::Test::Generator::generate($infile, $outfile);</td></tr>
<tr><td class="h">196</td><td colspan="6"></td></tr><tr><td class="h">197</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="bin-fuzz-harness-generator--branch.html#L197">50</a></div></td><td></td><td></td><td><div>42</div></td><td class="s">if($outfile) {</td></tr>
<tr><td class="h">198</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L198">50</a></div></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod 0755, $outfile if($outfile =~ /\.(pl|cgi)$/);</td></tr>
<tr><td class="h">199</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L199">50</a></div></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($run) {</td></tr>
<tr><td class="h">200</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(&quot;prove -l $outfile&quot;);</td></tr>
<tr><td class="h">201</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">203</td><td colspan="6"></td></tr><tr><td class="h">204</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">exit 0;</td></tr>
<tr><td class="h">205</td><td colspan="6"></td></tr><tr><td class="h">206</td><td></td><td></td><td></td><td></td><td></td><td class="s"># ---------------------------------------------------------------------------</td></tr>
<tr><td class="h">207</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Helpers for --replay-corpus</td></tr>
<tr><td class="h">208</td><td></td><td></td><td></td><td></td><td></td><td class="s"># ---------------------------------------------------------------------------</td></tr>
<tr><td class="h">209</td><td colspan="6"></td></tr><tr><td class="h">210</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Collect corpus JSON files from a path that is either a single file or a dir</td></tr>
<tr><td class="h">211</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _collect_corpus_files {</td></tr>
<tr><td class="h">212</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--subroutine.html#L212">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($path) = @_;</td></tr>
<tr><td class="h">213</td><td colspan="6"></td></tr><tr><td class="h">214</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L214">0</a></div><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L214">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (-f $path) {</td></tr>
<tr><td class="h">215</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ($path);</td></tr>
<tr><td class="h">216</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif (-d $path) {</td></tr>
<tr><td class="h">217</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @files = glob(File::Spec-&gt;catfile($path, &#39;*.json&#39;));</td></tr>
<tr><td class="h">218</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return sort @files;</td></tr>
<tr><td class="h">219</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">220</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return ();</td></tr>
<tr><td class="h">221</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">222</td><td colspan="6"></td></tr><tr><td class="h">223</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Read corpus files and generate a complete .t file as a string</td></tr>
<tr><td class="h">224</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _generate_replay_tap {</td></tr>
<tr><td class="h">225</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--subroutine.html#L225">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my (@corpus_files) = @_;</td></tr>
<tr><td class="h">226</td><td colspan="6"></td></tr><tr><td class="h">227</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $json_module;</td></tr>
<tr><td class="h">228</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $mod (qw(JSON::MaybeXS JSON)) {</td></tr>
<tr><td class="h">229</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L229">0</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L229">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;require $mod&quot; and $json_module = $mod and last;</td></tr>
<tr><td class="h">230</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">231</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L231">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &#39;No JSON module available; install JSON or JSON::MaybeXS&#39;</td></tr>
<tr><td class="h">232</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless $json_module;</td></tr>
<tr><td class="h">233</td><td colspan="6"></td></tr><tr><td class="h">234</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect all bugs across all corpus files</td></tr>
<tr><td class="h">235</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @tests;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# [{module =&gt; ..., method =&gt; ..., input =&gt; ..., error =&gt; ...}]</td></tr>
<tr><td class="h">236</td><td colspan="6"></td></tr><tr><td class="h">237</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $file (@corpus_files) {</td></tr>
<tr><td class="h">238</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L238">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open my $fh, &#39;&lt;&#39;, $file or die &quot;Cannot read $file: $!&quot;;</td></tr>
<tr><td class="h">239</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $data = eval {</td></tr>
<tr><td class="h">240</td><td><div class="c0">0</div><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$json_module-&gt;new-&gt;decode(do { local $/; &lt;$fh&gt; })</td></tr>
<tr><td class="h">241</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">242</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">243</td><td colspan="6"></td></tr><tr><td class="h">244</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L244">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($@) {</td></tr>
<tr><td class="h">245</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn &quot;Skipping $file: could not parse JSON: $@\n&quot;;</td></tr>
<tr><td class="h">246</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next;</td></tr>
<tr><td class="h">247</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">248</td><td colspan="6"></td></tr><tr><td class="h">249</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L249">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $bugs = $data-&gt;{bugs} // [];</td></tr>
<tr><td class="h">250</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L250">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless @$bugs;</td></tr>
<tr><td class="h">251</td><td colspan="6"></td></tr><tr><td class="h">252</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Derive method name from filename: translate.json -&gt; translate</td></tr>
<tr><td class="h">253</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my (undef, undef, $fname) = File::Spec-&gt;splitpath($file);</td></tr>
<tr><td class="h">254</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $method = $fname) =~ s/\.json$//;</td></tr>
<tr><td class="h">255</td><td colspan="6"></td></tr><tr><td class="h">256</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# The corpus file doesn&#39;t store the module name, but the schema</td></tr>
<tr><td class="h">257</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# directory will have a YAML file with the same stem that does.</td></tr>
<tr><td class="h">258</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Try to find it; fall back to a placeholder if not found.</td></tr>
<tr><td class="h">259</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L259">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $module = _infer_module_from_schema($file, $method) // &#39;UNKNOWN::Module&#39;;</td></tr>
<tr><td class="h">260</td><td colspan="6"></td></tr><tr><td class="h">261</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $bug (@$bugs) {</td></tr>
<tr><td class="h">262</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @tests, {</td></tr>
<tr><td class="h">263</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;module =&gt; $module,</td></tr>
<tr><td class="h">264</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method =&gt; $method,</td></tr>
<tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;input =&gt; $bug-&gt;{input},</td></tr>
<tr><td class="h">266</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error =&gt; $bug-&gt;{error},</td></tr>
<tr><td class="h">267</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;file =&gt; $file,</td></tr>
<tr><td class="h">268</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">269</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">270</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">271</td><td colspan="6"></td></tr><tr><td class="h">272</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Build the .t content</td></tr>
<tr><td class="h">273</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $test_count = scalar @tests;</td></tr>
<tr><td class="h">274</td><td colspan="6"></td></tr><tr><td class="h">275</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $t = &lt;&lt;&#39;HEADER&#39;;</td></tr>
<tr><td class="h">276</td><td></td><td></td><td></td><td></td><td></td><td class="s">#!/usr/bin/env perl</td></tr>
<tr><td class="h">277</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Auto-generated by fuzz-harness-generator --replay-corpus</td></tr>
<tr><td class="h">278</td><td></td><td></td><td></td><td></td><td></td><td class="s"># DO NOT EDIT - regenerate from corpus files instead</td></tr>
<tr><td class="h">279</td><td></td><td></td><td></td><td></td><td></td><td class="s">use strict;</td></tr>
<tr><td class="h">280</td><td></td><td></td><td></td><td></td><td></td><td class="s">use warnings;</td></tr>
<tr><td class="h">281</td><td></td><td></td><td></td><td></td><td></td><td class="s">use Test::More;</td></tr>
<tr><td class="h">282</td><td></td><td></td><td></td><td></td><td></td><td class="s">HEADER</td></tr>
<tr><td class="h">283</td><td colspan="6"></td></tr><tr><td class="h">284</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L284">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($test_count == 0) {</td></tr>
<tr><td class="h">285</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t .= &quot;\nplan skip_all =&gt; &#39;No bugs recorded in corpus files&#39;;\n&quot;;</td></tr>
<tr><td class="h">286</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $t;</td></tr>
<tr><td class="h">287</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">288</td><td colspan="6"></td></tr><tr><td class="h">289</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Collect unique modules to load</td></tr>
<tr><td class="h">290</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %modules = map { $_-&gt;{module} =&gt; 1 } @tests;</td></tr>
<tr><td class="h">291</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $mod (sort keys %modules) {</td></tr>
<tr><td class="h">292</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L292">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $mod eq &#39;UNKNOWN::Module&#39;;</td></tr>
<tr><td class="h">293</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t .= &quot;use $mod;\n&quot;;</td></tr>
<tr><td class="h">294</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">295</td><td colspan="6"></td></tr><tr><td class="h">296</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t .= &quot;\nplan tests =&gt; $test_count;\n\n&quot;;</td></tr>
<tr><td class="h">297</td><td colspan="6"></td></tr><tr><td class="h">298</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $i (0 .. $#tests) {</td></tr>
<tr><td class="h">299</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $test = $tests[$i];</td></tr>
<tr><td class="h">300</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $n = $i + 1;</td></tr>
<tr><td class="h">301</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $input = _format_input($test-&gt;{input});</td></tr>
<tr><td class="h">302</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $label = &quot;$test-&gt;{method} does not die on input from $test-&gt;{file}&quot;;</td></tr>
<tr><td class="h">303</td><td colspan="6"></td></tr><tr><td class="h">304</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Escape the error for use in a comment</td></tr>
<tr><td class="h">305</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L305">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $orig_error = $test-&gt;{error} // &#39;&#39;) =~ s/\n/ /g;</td></tr>
<tr><td class="h">306</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$orig_error =~ s/&#39;/\\&#39;/g;</td></tr>
<tr><td class="h">307</td><td colspan="6"></td></tr><tr><td class="h">308</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t .= &quot;# Corpus bug: $orig_error\n&quot;;</td></tr>
<tr><td class="h">309</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t .= &quot;lives_ok { $test-&gt;{module}\-&gt;$test-&gt;{method}($input) }\n&quot;;</td></tr>
<tr><td class="h">310</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t .= &quot;&nbsp;&nbsp;&nbsp;&nbsp;&#39;$label&#39;;\n\n&quot;;</td></tr>
<tr><td class="h">311</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">312</td><td colspan="6"></td></tr><tr><td class="h">313</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# lives_ok is in Test::Exception; add a use at the top</td></tr>
<tr><td class="h">314</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$t =~ s/(use Test::More;)/$1\nuse Test::Exception;/;</td></tr>
<tr><td class="h">315</td><td colspan="6"></td></tr><tr><td class="h">316</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $t;</td></tr>
<tr><td class="h">317</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">318</td><td colspan="6"></td></tr><tr><td class="h">319</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Format a scalar input value as a Perl literal for embedding in source</td></tr>
<tr><td class="h">320</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _format_input {</td></tr>
<tr><td class="h">321</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--subroutine.html#L321">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($input) = @_;</td></tr>
<tr><td class="h">322</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L322">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &#39;undef&#39; unless defined $input;</td></tr>
<tr><td class="h">323</td><td colspan="6"></td></tr><tr><td class="h">324</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Numeric</td></tr>
<tr><td class="h">325</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L325">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $input if $input =~ /^-?(?:\d+\.?\d*|\.\d+)$/;</td></tr>
<tr><td class="h">326</td><td colspan="6"></td></tr><tr><td class="h">327</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# String: escape single quotes and backslashes</td></tr>
<tr><td class="h">328</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(my $escaped = $input) =~ s/\\/\\\\/g;</td></tr>
<tr><td class="h">329</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$escaped =~ s/&#39;/\\&#39;/g;</td></tr>
<tr><td class="h">330</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return &quot;&#39;$escaped&#39;&quot;;</td></tr>
<tr><td class="h">331</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">332</td><td colspan="6"></td></tr><tr><td class="h">333</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Try to find the module name from the YAML schema file that sits alongside</td></tr>
<tr><td class="h">334</td><td></td><td></td><td></td><td></td><td></td><td class="s"># the corpus file.&nbsp;&nbsp;The corpus lives in schemas/corpus/method.json;</td></tr>
<tr><td class="h">335</td><td></td><td></td><td></td><td></td><td></td><td class="s"># the schema is at schemas/method.yaml (or .yml).</td></tr>
<tr><td class="h">336</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub _infer_module_from_schema {</td></tr>
<tr><td class="h">337</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="bin-fuzz-harness-generator--subroutine.html#L337">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($corpus_file, $method) = @_;</td></tr>
<tr><td class="h">338</td><td colspan="6"></td></tr><tr><td class="h">339</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my (undef, $corpus_dir) = File::Spec-&gt;splitpath($corpus_file);</td></tr>
<tr><td class="h">340</td><td colspan="6"></td></tr><tr><td class="h">341</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Walk up one directory from corpus/ to find the schemas/ dir</td></tr>
<tr><td class="h">342</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $schema_dir = File::Spec-&gt;catdir($corpus_dir, File::Spec-&gt;updir());</td></tr>
<tr><td class="h">343</td><td colspan="6"></td></tr><tr><td class="h">344</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for my $ext (qw(yaml yml)) {</td></tr>
<tr><td class="h">345</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $schema_file = File::Spec-&gt;catfile($schema_dir, &quot;$method.$ext&quot;);</td></tr>
<tr><td class="h">346</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L346">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless -f $schema_file;</td></tr>
<tr><td class="h">347</td><td colspan="6"></td></tr><tr><td class="h">348</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L348">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open my $fh, &#39;&lt;&#39;, $schema_file or next;</td></tr>
<tr><td class="h">349</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (&lt;$fh&gt;) {</td></tr>
<tr><td class="h">350</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="bin-fuzz-harness-generator--branch.html#L350">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (/^module:\s*(\S+)/) {</td></tr>
<tr><td class="h">351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">352</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $1;</td></tr>
<tr><td class="h">353</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">354</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">355</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">356</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">357</td><td colspan="6"></td></tr><tr><td class="h">358</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">359</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">360</td><td colspan="6"></td></tr></table>
</body>
</html>
