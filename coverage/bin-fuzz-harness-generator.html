<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.51
Devel::Cover is copyright 2001-2025, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
https://pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: bin/fuzz-harness-generator</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">bin/fuzz-harness-generator</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">74.8%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s">#!/usr/bin/env perl</td></tr>
<tr><td class="h">2</td><td colspan="6"></td></tr><tr><td class="h">3</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L3">6</a></div></td><td><div>11645</div><div>6</div><div>102</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">4</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L4">6</a></div></td><td><div>9</div><div>4</div><div>115</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">5</td><td colspan="6"></td></tr><tr><td class="h">6</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L6">6</a></div></td><td><div>1725</div><div>10</div><div>136</div></td><td class="s">use App::Test::Generator;</td></tr>
<tr><td class="h">7</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L7">6</a></div></td><td><div>14</div><div>5</div><div>16</div></td><td class="s">use autodie qw(:all);</td></tr>
<tr><td class="h">8</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L8">6</a></div></td><td><div>12646</div><div>3</div><div>221</div></td><td class="s">use File::Temp;</td></tr>
<tr><td class="h">9</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L9">6</a></div></td><td><div>1919</div><div>27527</div><div>13</div></td><td class="s">use Getopt::Long qw(GetOptions);</td></tr>
<tr><td class="h">10</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="bin-fuzz-harness-generator--subroutine.html#L10">6</a></div></td><td><div>1826</div><div>109596</div><div>1642</div></td><td class="s">use Pod::Usage;</td></tr>
<tr><td class="h">11</td><td colspan="6"></td></tr><tr><td class="h">12 - 60</td><td colspan="5"></td><td class="s"><pre>=head1 NAME

fuzz-harness-generator - Generate fuzzing + corpus-based test harnesses from test schemas

=head1 SYNOPSIS

&nbsp;&nbsp;fuzz-harness-generator [-r] [-o output_file] input_file

&nbsp;&nbsp;fuzz-harness-generator --dry-run input.yaml

=head1 DESCRIPTION

This tool generates a C&lt;t/fuzz.t&gt; test file that fuzzes and validates a target module&#39;s function or method,
using both randomized fuzz cases and static corpus
cases (Perl or YAML).

=head1 OPTIONS

=over 4

=item B&lt;--help&gt;

Show this help.

=item B&lt;--input&gt;

The input configuration file

=item B&lt;--output&gt;

The (optional) output file.

=item B&lt;--dry-run&gt;

Validate the input configuration and schema extraction without writing any output files or running tests.

=item B&lt;--run&gt;

Call C&lt;prove&gt; on the output file.

C&lt;fuzz-harness-generator -r t/conf/data_text_append.conf&gt; will, therefore, dynamically create and run tests on the C&lt;append&gt; method of L&lt;Data::Text&gt;

=item B&lt;--version&gt;

Prints the version of L&lt;App::Test::Generator&gt;

=back

=cut</pre></td></tr>
<tr><td class="h">61</td><td colspan="6"></td></tr><tr><td class="h">62</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>431226</div></td><td class="s">my $infile;</td></tr>
<tr><td class="h">63</td><td></td><td></td><td></td><td></td><td></td><td class="s">my $outfile;</td></tr>
<tr><td class="h">64</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $help;</td></tr>
<tr><td class="h">65</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $run;</td></tr>
<tr><td class="h">66</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $verbose;</td></tr>
<tr><td class="h">67</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $version;</td></tr>
<tr><td class="h">68</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">my $dry_run;</td></tr>
<tr><td class="h">69</td><td colspan="6"></td></tr><tr><td class="h">70</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">Getopt::Long::Configure(&#39;bundling&#39;);</td></tr>
<tr><td class="h">71</td><td colspan="6"></td></tr><tr><td class="h">72</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L72">50</a></div></td><td></td><td></td><td><div>134</div></td><td class="s">GetOptions(</td></tr>
<tr><td class="h">73</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;help|h&#39; =&gt; \$help,</td></tr>
<tr><td class="h">74</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;input|i=s&#39; =&gt; \$infile,</td></tr>
<tr><td class="h">75</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;dry-run|n&#39; =&gt; \$dry_run,</td></tr>
<tr><td class="h">76</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;output|o=s&#39; =&gt; \$outfile,</td></tr>
<tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;run|r&#39; =&gt; \$run,</td></tr>
<tr><td class="h">78</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;verbose|v&#39; =&gt; \$verbose,</td></tr>
<tr><td class="h">79</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;version|V&#39; =&gt; \$version,</td></tr>
<tr><td class="h">80</td><td></td><td></td><td></td><td></td><td></td><td class="s">) or pod2usage(2);</td></tr>
<tr><td class="h">81</td><td colspan="6"></td></tr><tr><td class="h">82</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L82">100</a></div></td><td></td><td></td><td><div>2960</div></td><td class="s">pod2usage(-exitval =&gt; 0, -verbose =&gt; 1) if($help);</td></tr>
<tr><td class="h">83</td><td colspan="6"></td></tr><tr><td class="h">84</td><td><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L84">100</a></div></td><td></td><td></td><td><div>9</div></td><td class="s">if($version) {</td></tr>
<tr><td class="h">85</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print $App::Test::Generator::VERSION, &quot;\n&quot;;</td></tr>
<tr><td class="h">86</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 0;</td></tr>
<tr><td class="h">87</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">88</td><td colspan="6"></td></tr><tr><td class="h">89</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L89">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L89">33</a></div></td><td></td><td><div>16</div></td><td class="s">if($infile &amp;&amp; @ARGV) {</td></tr>
<tr><td class="h">90</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pod2usage(&#39;Specify input file either as argument or via --input, not both&#39;);</td></tr>
<tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">92</td><td colspan="6"></td></tr><tr><td class="h">93</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L93">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L93">33</a></div></td><td></td><td><div>11</div></td><td class="s">$infile ||= shift @ARGV or pod2usage(&#39;No config file given&#39;);</td></tr>
<tr><td class="h">94</td><td colspan="6"></td></tr><tr><td class="h">95</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L95">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L95">67</a></div></td><td></td><td><div>12</div></td><td class="s">if($dry_run &amp;&amp; $run) {</td></tr>
<tr><td class="h">96</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pod2usage(&#39;--dry-run cannot be used with --run&#39;);</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">98</td><td colspan="6"></td></tr><tr><td class="h">99</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L99">100</a></div></td><td><div class="c3"><a href="bin-fuzz-harness-generator--condition.html#L99">100</a></div></td><td></td><td><div>8</div></td><td class="s">if ($dry_run &amp;&amp; $outfile) {</td></tr>
<tr><td class="h">100</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn &#39;--dry-run specified; --output will be ignored&#39;;</td></tr>
<tr><td class="h">101</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">102</td><td colspan="6"></td></tr><tr><td class="h">103</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L103">50</a></div></td><td></td><td></td><td><div>240</div></td><td class="s">if($verbose) {</td></tr>
<tr><td class="h">104</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ENV{&#39;TEST_VERBOSE&#39;} = 1;</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">106</td><td colspan="6"></td></tr><tr><td class="h">107</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L107">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L107">33</a></div></td><td></td><td><div>29</div></td><td class="s">if($run &amp;&amp; !$outfile) {</td></tr>
<tr><td class="h">108</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $fh;</td></tr>
<tr><td class="h">109</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($fh, $outfile) = File::Temp::tempfile();</td></tr>
<tr><td class="h">110</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">111</td><td colspan="6"></td></tr><tr><td class="h">112</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;App::Test::Generator::generate($infile, $outfile);</td></tr>
<tr><td class="h">113</td><td colspan="6"></td></tr><tr><td class="h">114</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit system(&#39;prove&#39;, &#39;-l&#39;, $outfile) &gt;&gt; 8;</td></tr>
<tr><td class="h">115</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">116</td><td colspan="6"></td></tr><tr><td class="h">117</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L117">100</a></div><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L117">50</a></div></td><td><div class="c0"><a href="bin-fuzz-harness-generator--condition.html#L117">25</a></div></td><td></td><td><div>14</div></td><td class="s">if ($dry_run) {</td></tr>
<tr><td class="h">118</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ($fh, $tmp) = File::Temp::tempfile();</td></tr>
<tr><td class="h">119</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>892</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close $fh;</td></tr>
<tr><td class="h">120</td><td colspan="6"></td></tr><tr><td class="h">121</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval {</td></tr>
<tr><td class="h">122</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;App::Test::Generator::generate($infile, $tmp);</td></tr>
<tr><td class="h">123</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>136</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1;</td></tr>
<tr><td class="h">124</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="bin-fuzz-harness-generator--branch.html#L124">100</a></div></td><td></td><td></td><td><div>1312</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} or do {</td></tr>
<tr><td class="h">125</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>338</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Dry-run failed for $infile: $@&quot;;</td></tr>
<tr><td class="h">126</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">127</td><td colspan="6"></td></tr><tr><td class="h">128</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unlink $tmp;</td></tr>
<tr><td class="h">129</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>777</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;Dry-run OK: $infile parsed and validated successfully\n&quot;;</td></tr>
<tr><td class="h">130</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>67</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 0;</td></tr>
<tr><td class="h">131</td><td></td><td></td><td></td><td></td><td></td><td class="s">} elsif($outfile &amp;&amp; -e $outfile &amp;&amp; !$run) {</td></tr>
<tr><td class="h">132</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warn &quot;Overwriting existing file: $outfile&quot;;</td></tr>
<tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">134</td><td colspan="6"></td></tr><tr><td class="h">135</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">App::Test::Generator::generate($infile, $outfile);</td></tr>
<tr><td class="h">136</td><td colspan="6"></td></tr><tr><td class="h">137</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="bin-fuzz-harness-generator--branch.html#L137">50</a></div></td><td></td><td></td><td><div>88</div></td><td class="s">if($outfile) {</td></tr>
<tr><td class="h">138</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L138">50</a></div></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chmod 0755, $outfile if($outfile =~ /\.(pl|cgi)$/);</td></tr>
<tr><td class="h">139</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="bin-fuzz-harness-generator--branch.html#L139">50</a></div></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($run) {</td></tr>
<tr><td class="h">140</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;system(&quot;prove -l $outfile&quot;);</td></tr>
<tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">143</td><td colspan="6"></td></tr><tr><td class="h">144</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">exit 0;</td></tr>
</table>
</body>
</html>
